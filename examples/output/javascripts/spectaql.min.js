'use strict'
function scrollSpy() {
  var c = 'nav-scroll-active',
    l = 'nav-scroll-expand',
    s = null,
    a = []
  function e() {
    s = null
    var e = document.querySelectorAll('[data-traverse-target]')
    Array.prototype.forEach.call(e, function (e) {
      a.push({ id: e.id, top: e.offsetTop })
    })
  }
  var t = debounce(function () {
      e(), o()
    }, 50),
    o = debounce(function () {
      var e,
        t,
        o,
        n,
        r = (function (e) {
          for (var t = e + 5, o = 0; o < a.length; o++) {
            var n = a[o],
              r = a[o + 1]
            if (t >= n.top && (!r || t < r.top)) return o
          }
          return -1
        })(document.documentElement.scrollTop || document.body.scrollTop)
      r !== s &&
        ((o = a[(s = r)]),
        (n = function (e) {
          return e && e.closest ? e.closest('.nav-group-section') : null
        }),
        (e = document.querySelector(`.${c}`)),
        (r = n(
          (t = o ? document.querySelector('a[href*=' + o.id + ']') : null)
        )),
        (n = (o = n(e)) !== r),
        o && n && o.classList.remove(l),
        r && n && r.classList.add(l),
        t &&
          (t.classList.add(c),
          t.scrollIntoViewIfNeeded
            ? t.scrollIntoViewIfNeeded()
            : t.scrollIntoView && t.scrollIntoView({ behavior: 'smooth' })),
        e && e.classList.remove(c))
    }, 30)
  setTimeout(function () {
    e(),
      o(),
      window.addEventListener('scroll', o),
      window.addEventListener('resize', t)
  }, 300)
}
function toggleMenu() {
  var t = 'drawer-open',
    e = document.querySelector('#spectaql .sidebar-open-button'),
    o = document.querySelector('#spectaql #sidebar .close-button'),
    n = document.querySelector('#spectaql .drawer-overlay')
  function r() {
    var e = document.querySelector('#spectaql #page')
    e.classList.contains(t) ? e.classList.remove(t) : e.classList.add(t)
  }
  e.addEventListener('click', r),
    o.addEventListener('click', r),
    n.addEventListener('click', r)
}
function debounce(e, t) {
  var o = null
  return function () {
    clearTimeout(o),
      (o = setTimeout(function () {
        e.apply(null)
      }, t))
  }
}
window.addEventListener('DOMContentLoaded', (e) => {
  toggleMenu(), scrollSpy()
})
